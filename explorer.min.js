const mailBox = document.getElementById("mailBox");
const pageTitle = document.getElementById("pageTitle");
const e404 = `
	  <div class="mailDiv">
	  <label>Author <span style="color:blue;">REQUEST ERROR</span></label>
		<div class="mailTitle">Error 404</div>
		<div class="mailBody">
    <center><img src="img/404.png" style="width:250px" alt="404 ERROR"></center><label style="padding-left:20vw;">- Page not found.</label><br>
		<label style="padding-left:20vw;">- <a href="https://gardennet.netlify.app/explorer?gid=2&gname=GardenNetDoc" target="_blank">Click here</a> to read GardenNet Documentetion.</label><br>
		<label style="padding-left:20vw;">- If you are not connected with internet, connect it and try again.</label><br><hr>
		<center><button class="nbtn" onclick="location.reload()">Try Again</button></center>
		</div>
	  </div>
	  `;
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
    apiKey: "AIzaSyBaPvnzqor_4HfPZg6ayk30Tb1RpcMBWfo",
    authDomain: "test-66b58.firebaseapp.com",
    projectId: "test-66b58",
    storageBucket: "test-66b58.appspot.com",
    messagingSenderId: "39985206495",
    appId: "1:39985206495:web:c4200c42a6e7bad4da456a",
    measurementId: "G-G1RBDR6H1S"
};
firebase.initializeApp(firebaseConfig);
const dbRef = firebase.database().ref();
let url = location.href;
let paramaters = (new URL(url)).searchParams;
let gid = paramaters.get("gid");
let gname = paramaters.get("gname");
if(paramaters.get('emb')){
	let emb = paramaters.get('emb');
	if(emb=='emb'){
		document.querySelector('#logoDiv').style.display='none';
	}
}

var mails;
var mail;
var all;
function getData(i,n) {
  dbRef.child("mails").child(i).child("mails").child(n).get().then((snapshot) => {
    if (snapshot.exists()) {
      mails = snapshot.val();
      loadMails();
    } else {
      mailBox.innerHTML=e404;
      pageTitle.textContent='404 not found';
    }
  }).catch((error) => {
    location.href=location.href;
  });
}

function loadMails() {
  pageTitle.textContent=`${mails.title} - Explorer GardenNet`;
  mailBox.innerHTML=`
  <div class="mailDiv">
  <label>Author <span style="color:blue;">${mails.user}.</span></label>
  <div class="mailTitle">${mails.title}</div>
  <div class="mailBody">${mails.body}</div>
  </div>
`;

}
setTimeout(1000);
getData(gid,gname);
function run(code){document.documentElement.innerHTML=code}