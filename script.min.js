const firebaseConfig={apiKey:"AIzaSyBaPvnzqor_4HfPZg6ayk30Tb1RpcMBWfo",authDomain:"test-66b58.firebaseapp.com",projectId:"test-66b58",storageBucket:"test-66b58.appspot.com",messagingSenderId:"39985206495",appId:"1:39985206495:web:c4200c42a6e7bad4da456a",measurementId:"G-G1RBDR6H1S"};firebase.initializeApp(firebaseConfig);const db=firebase.firestore();let idget=null;const dbRef=firebase.database().ref();dbRef.child("id").child("id").get().then(snapshot=>{snapshot.exists()?idget=snapshot.val():alert("No Internet Connection")}).catch(error=>{console.error(error)});let userdata={},uif,currentPassword;async function getUserData(x){dbRef.child("users").child(x).get().then(snapshot=>{snapshot.exists()?userdata=snapshot.val():console.warn("No data available")}).catch(error=>{console.error(error)})}function setUser(name,email,pImg,pwd,uid){return uif={name:name,email:email,pImg:pImg,pwd:pwd,uid:uid},uif}function SignUp(){""==usernameSignUp.value?alert("Enter your username and try again."):passwordSignUp.value==passwordSignUpAgain.value&&""!=passwordSignUp.value?""==emailSignUp.value?alert("Please enter your email and try again."):(writeUserData(++idget,usernameSignUp.value,emailSignUp.value,"img/defProfilePicture.jpg",passwordSignUp.value,idget),currentPassword=passwordSignUp.value,alert("SignUp Successful"),alert(`Your UserId is ${idget}`),LogInAuto()):alert("Your passwords didn't match.")}var un,em,pi,ps,uid;function dashboard(){startDiv.style="display:none;",dashBoard.style=`display:flex;width:${window.innerWidth};`;let a=uif;un=a.name,em=a.email,pi=a.pImg,ps=a.pwd,uid=a.uid,usernameBD.innerHTML=un,idDB.innerHTML='<label class="uds">User ID : </label>'+uid,menu.style="display:block",localStorage.setItem("id",uif.uid),localStorage.setItem("pw",uif.pwd),autologin()}function LogOut(){location.href="index.html"}async function LogIn(){""==idLogIn.value?alert("Enter your user id and try again."):(getUserData(idLogIn.value),setUser(userdata.username,userdata.email,userdata.profile_picture,userdata.password,userdata.id),setTimeout(check,1e3))}async function LogInAuto(){getUserData(idget),setTimeout(check2,1e3)}function check2(){currentPassword==userdata.password?(setUser(userdata.username,userdata.email,userdata.profile_picture,userdata.password,userdata.id),setTimeout(dashboard,500)):alert("Login Error")}function check(){passwordLogIn.value==userdata.password?(setUser(userdata.username,userdata.email,userdata.profile_picture,userdata.password,userdata.id),setTimeout(dashboard,500)):alert("password didn't match.")}function writeUserData(userId,name,email,imageUrl,pwd,oid){firebase.database().ref("id").set({id:userId}),firebase.database().ref("users/"+userId).set({username:name,email:email,profile_picture:imageUrl,password:pwd,id:oid})}function autologin(){getUserData(parseInt(localStorage.getItem("id"))),setTimeout(check3,1e3)}function check3(){parseInt(localStorage.getItem("id"))==userdata.password?(setUser(userdata.username,userdata.email,userdata.profile_picture,userdata.password,userdata.id),setTimeout(dashboard,1e3)):console.error("Login Error")}autologin();
